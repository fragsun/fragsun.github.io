# 用户身份与文件权限
## 1. 用户身份与能力

root管理员就是存在于所有类UNIX系统中的超级用户。它拥有最高的系统所有权，能够管理系统的各项功能，如添加/删除用户、启动/关闭服务进程、开启/禁用硬件设备等。
Linux系统的管理员之所以是root，并不是因为它的名字叫root，而是因为该用户的身份号码即UID（User IDentification）的数值为0。在Linux系统中，UID就相当于我们的身份证号码一样具有唯一性，因此可通过用户的UID值来判断用户身份。

1. 管理员UID为0：系统的管理员用户。
2. 系统用户UID为1～999： Linux系统为了避免因某个服务程序出现漏洞而被黑客提权至整台服务器，默认服务程序会有独立的系统用户负责运行，进而有效控制被破坏范围。
3. 普通用户UID从1000开始：是由管理员创建的用于日常工作的用户。

UID是不能冲突的，而且管理员创建的普通用户的UID默认是从1000开始的（即使前面有闲置的号码）。

Linux系统中还引入了用户组的概念，通过使用用户组号码（GID，Group IDentification），我们可以把多个用户加入到同一个组中，从而方便为组中的用户统一规划权限或指定任务。
在Linux系统中创建每个用户时，将自动创建一个与其同名的基本用户组，而且这个基本用户组只有该用户一个人。如果该用户以后被归纳入其他用户组，则这个其他用户组称之为扩展用户组。一个用户只有一个基本用户组，但是可以有多个扩展用户组。

### 1.1 useradd
useradd命令用于创建新的用户，格式为“useradd [选项] 用户名”。

使用该命令创建用户账户时，默认的用户家目录会被存放在/home目录中，默认的Shell解释器为/bin/bash，而且默认会创建一个与该用户同名的基本用户组。这些默认设置可以根据useradd命令参数自行修改。

<table>
	<tr>
		<td>参数</td>
		<td>作用</td>
	</tr>
	<tr>
		<td>-d</td>
		<td>指定用户的家目录（默认为/home/username）</td>
	</tr>
	<tr>
		<td>-u</td>
		<td>指定该用户的默认UID</td>
	</tr>
	<tr>
		<td>-g</td>
		<td>指定一个初始的用户基本组（必须已存在）</td>
	</tr>
	<tr>
		<td>-G</td>
		<td>指定一个或多个扩展用户组</td>
	</tr>
	<tr>
		<td>-s</td>
		<td>指定该用户的默认Shell解释器</td>
	</tr>
</table>

### 1.2 usermod
usermod命令用于修改用户的属性，格式为“usermod [选项] 用户名”。

用户的信息保存在/etc/passwd文件中，可以直接用文本编辑器来修改其中的用户参数项目，也可以用usermod命令修改已经创建的用户信息，诸如用户的UID、基本/扩展用户组、默认终端等。usermod命令的参数以及作用如表所示。

<table>
	<tr>
		<td>参数</td>
		<td>作用</td>
	</tr>
	<tr>
		<td>-c</td>
		<td>填写用户账户的备注信息</td>
	</tr>
	<tr>
		<td>-d –m</td>
		<td>参数-m与参数-d连用，可重新指定用户的家目录并自动把旧的数据转移过去</td>
	</tr>
	<tr>
		<td>-g</td>
		<td>变更所属用户组</td>
	</tr>
	<tr>
		<td>-G</td>
		<td>变更扩展用户组</td>
	</tr>
	<tr>
		<td>-L</td>
		<td>锁定用户禁止其登录系统</td>
	</tr>
	<tr>
		<td>-U</td>
		<td>解锁用户，允许其登录系统</td>
	</tr>
	<tr>
		<td>-s</td>
		<td>变更默认终端</td>
	</tr>
	<tr>
		<td>-u</td>
		<td>修改用户的UID</td>
	</tr>
</table>

### 1.3 passwd
passwd命令用于修改用户密码、过期时间、认证信息等，格式为“passwd [选项] [用户名]”。

普通用户只能使用passwd命令修改自身的系统密码，而root管理员则有权限修改其他所有人的密码，root管理员在Linux系统中修改自己或他人的密码时不需要验证旧密码。 passwd命令中可用的参数以及作用如表所示。

<table>
	<tr>
		<td>参数</td>
		<td>作用</td>
	</tr>
	<tr>
		<td>-l</td>
		<td>锁定用户，禁止其登录</td>
	</tr>
	<tr>
		<td>-u</td>
		<td>解除锁定，允许用户登录</td>
	</tr>
	<tr>
		<td>-d</td>
		<td>使该用户可用空密码登录系统</td>
	</tr>
</table>

### 1.4 userdel
userdel命令用于删除用户，格式为“userdel [选项] 用户名”。

通过userdel命令删除该用户的所有信息。在执行删除操作时，该用户的家目录默认会保留下来，此时可以使用-r参数将其删除。

###1.5 groupadd
groupadd命令用于创建用户组，格式为“groupadd [选项] 群组名”。

## 2. 文件权限与归属
在Linux系统中一切都是文件，但是每个文件的类型不尽相同，因此Linux系统使用了不同的字符来加以区分，常见的字符如下所示。

<table>
	<tr>
		<td>字符</td>
		<td>文件类型</td>
	</tr>
	<tr>
		<td>-</td>
		<td>普通文件</td>
	</tr>
	<tr>
		<td>d</td>
		<td>目录文件</td>
	</tr>
	<tr>
		<td>l</td>
		<td>链接文件</td>
	</tr>
	<tr>
		<td>b</td>
		<td>块设备文件</td>
	</tr>
	<tr>
		<td>c</td>
		<td>字符设备文件</td>
	</tr>
	<tr>
		<td>p</td>
		<td>管道文件</td>
	</tr>
</table>

在Linux系统中，每个文件都有所属的所有者和所有组，并且规定了文件的所有者、所有组以及其他人对文件所拥有的可读（r）、可写（w）、可执行（x）等权限。文件的读、写、执行权限可以简写为rwx，亦可分别用数字4、2、1来表示，文件所有者，所属组及其他用户权限之间无关联。

* 对于一般文件来说，权限比较容易理解：“可读”表示能够读取文件的实际内容；“可写”表示能够编辑、新增、修改、删除文件的实际内容；“可执行”则表示能够运行一个脚本程序。
* 对目录文件来说，“可读”表示能够读取目录内的文件列表；“可写”表示能够在目录内新增、删除、重命名文件；而“可执行”则表示能够进入该目录。
 
文件权限的数字法表示基于字符表示（rwx）的权限计算而来，其目的是简化权限的表示。例如，若某个文件的权限为7则代表可读、可写、可执行（4+2+1）；若权限为6则代表可读、可写（4+2）。

## 3. su命令与sudo服务
su命令可以解决切换用户身份的需求，使得当前用户在不退出登录的情况下，顺畅地切换到其他用户。

su命令与用户名之间添加一个减号（-），这意味着完全切换到新的用户，即把环境变量信息也变更为新用户的相应信息，而不是保留原始的信息。

sudo命令用于给普通用户提供额外的权限来完成原本root管理员才能完成的任务，格式为“sudo [参数] 命令名称”。
参数	作用
-l	列出当前用户可执行的命令
-u 用户名或UID值	以指定的用户身份执行命令
-d	使该用户可用空密码登录系统

<table>
	<tr>
		<td>参数</td>
		<td>作用</td>
	</tr>
	<tr>
		<td>-l</td>
		<td>列出当前用户可执行的命令</td>
	</tr>
	<tr>
		<td>-u</td>
		<td>用户名或UID值	以指定的用户身份执行命令</td>
	</tr>
	<tr>
		<td>-d</td>
		<td>使该用户可用空密码登录系统</td>
	</tr>
</table>

sudo命令具有如下功能：

* 限制用户执行指定的命令：
* 记录用户执行的每一条命令；
* 配置文件（/etc/sudoers）提供集中的用户管理、权限与主机等参数；
* 验证密码的后5分钟内（默认值）无须再让用户再次验证密码。

默认每次执行sudo命令后都会要求验证当前登录用户的密码。
